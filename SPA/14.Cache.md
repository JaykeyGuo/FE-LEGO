## 缓存(Cache)

缓存是一种保存资源副本并在下次请求时直接使用该副本的技术。当 web 缓存发现请求的资源已经被存储，它会拦截请求，返回该资源的拷贝，而不用去源服务器重新下载。

优点：缓解服务器端压力，提升性能。

缓存驱逐：定期清理

### 浏览器缓存

- 为什么需要浏览器缓存？

    目的：提高页面性能，将资源储存在本地的浏览器中。部分资源比较大，并且会多次利用，每次刷新页面的时候从服务端请求对应资源是一个较消耗网络资源的事，所以通过缓存来存储一些“大文件”和“常用文件”，加速二次访问的速度，提高页面的性能。

- 缓存了什么？

    已经访问过的内容。

- 缓存如何命中？

    通过缓存的http header信息来判断，通过expires和cache-control来判断是否命中强缓存。

    命中：可以直接通过强缓存获取到需要的数据。

    不命中：无法直接通过缓存获取到想要的数据，浏览器直接从服务器加载资源时，Expires Header在重新加载的时候会被更新。 
    
    当浏览器对某个资源的请求没有命中强缓存，就会发一个请求到服务器，验证协商缓存是否命中，如果协商缓存命中，请求响应返回的http状态为304并且会显示一个Not Modified的字符串。

    协商缓存是利用的是【Last-Modified，If-Modified-Since】和【ETag、If-None-Match】这两对Header来管理的。

- 如何避免缓存带来的问题？图片在客户端缓存，之后更新，再次访问，无法获取图片。
    
    默认的处理方式：如果资源已经被浏览器缓存下来，在缓存失效之前，再次请求时，默认会先检查是否命中强缓存，如果强缓存命中则直接读取缓存，如果强缓存没有命中则发请求到服务器检查是否命中协商缓存，如果协商缓存命中，则告诉浏览器还是可以从缓存读取，否则才从服务器返回最新的资源。
        
### HTTP Header
Caching
- Age: 对象在缓存中的时间
- Cache-Control：缓存的状态，通过其来判断对应的缓存情况
- Clear-Site-Data：清理浏览数据（cookies，storage，cache）
- Expires：缓存的过期时间

限制属性
- Last-Modified：最后修改资源的时间，用于比较同一资源的多个版本，比Etag的命中率低。通过If-Modified-Since和If-Unmodified-Since来请求；
- Etag：用于验证资源版本的一个独特字符串，通过If-Match和If-None-Match来改变请求的行为。

通信管理：
- Connection：在当前处理完成之后，控制网络连接是否保持连通。
- Keep-Alive：控制一个持续连接应该持续多久。

Connect negotiation
- Accept：告知服务端关于可传输的数据类型。
- Accept-Charset：告知服务端哪些特性设置能够完成。
- Accept-Ecoding：告知服务端关于编码算法、通常一个压缩算法能使用在资源的回调

Request context
- From：包含一个控制用户代理请求的使用者的网络邮箱地址
- Host：指定监听的服务器域名与TCP端口号
- User-Agent：包含一个特定的字符串，允许相同网络协议的其他人来识别客户端的类型、操作系统、软件商或软件版本。

CORS （网络通信技术）
- Origin：表明一个返回来源是在哪
